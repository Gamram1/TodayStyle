<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="myPage">
	
	
	<!-- 프로필 이미지 경로 -->
	<select id="profileFilePath" resultType="string">
		SELECT
			filepath 
		FROM
			member_img
		WHERE
			user_id = #{userId}
	</select>
	
	<!-- 팔로잉 수 -->
	<select id="followingNum" resultType="string">
		SELECT
			count(*) AS following
		FROM
			follow
		WHERE
			user_id = #{userId}
	</select>
	<!-- 팔로워 수 -->
	<select id="followerNum" resultType="string">
		SELECT
			count(*) AS following
		FROM
			follow
		WHERE
			following_id = #{userId}
	</select>
	
	<!-- 사용자 코디 리스트 -->
	<select id="myCoordiList" resultType="myCoordiList">
		SELECT
			coordi.coordi_no as coordiNo, filepath as filepath
		FROM
			coordi
			LEFT JOIN coordi_img ON (coordi.coordi_no = coordi_img.coordi_no)
		WHERE
			user_id = #{userId} and top_yn='Y'
	</select>
	
	<!-- 사용자 잇템 리스트 -->
	<select id="myItTemList" resultType="myItTemList">
		SELECT
			it_item.it_itemno as itTemNo, filepath as filepath
		FROM
			it_item
			LEFT JOIN it_img ON (it_item.it_itemno = it_img.it_itemno)
		WHERE
			user_id = #{userId} and top_yn='Y'
	</select>
	
	<!-- 사용자 스크랩 코디 리스트 -->
	<select id="scrapCoordiList" resultType="kr.or.iei.myPage.model.vo.ScrapCoordiList">
		SELECT
		    coordi_scrap.coordi_scrap_no as coordiScrapNo,
		    coordi_scrap.coordi_no as CoordiNo,
		    coordi.user_id as coordiUserId,
		    coordi_img.filepath as coordiFilepath,
		    member_img.filepath as profileFilepath,
		    member.nickname as coordiNickname
		FROM
		    coordi_scrap
		        left join coordi on (coordi_scrap.coordi_no = coordi.coordi_no)
		        left join coordi_img on (coordi_scrap.coordi_no = coordi_img.coordi_no)
		        left join member_img on (coordi.user_id = member_img.user_id)
		        left join member on (coordi.user_id = member.user_id)
		WHERE
			coordi_scrap.user_id = #{userId}
		    AND
		    coordi_img.top_yn = 'Y'
		    AND
		    coordi.del_yn='N'
		ORDER BY
			coordiScrapNo DESC
	</select>
	
	<!-- 사용자 스크랩 잇템 리스트 -->
	<select id="scrapItTemList" resultType="kr.or.iei.myPage.model.vo.ScrapItTemList">
		SELECT
		    item_scrap.item_scrap_no as itTemScrapNo,
		    item_scrap.it_itemno as itTemNo,
		    it_item.user_id as itTemUserId,
		    it_img.filepath as itTemFilepath,
		    member_img.filepath as profileFilepath,
		    member.nickname as itTemNickname
		FROM
		    item_scrap
		        left join it_item on (item_scrap.it_itemno = it_item.it_itemno)
		        left join it_img on (item_scrap.it_itemno = it_img.it_itemno)
		        left join member_img on (it_item.user_id = member_img.user_id)
		        left join member on (it_item.user_id = member.user_id)
		WHERE
			item_scrap.user_id = #{userId}
		    AND
		    it_img.top_yn = 'Y'
		    AND
		    it_item.del_yn='N'
		ORDER BY
			itTemScrapNo DESC
	</select>
	
</mapper>
